{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Admin Search</h2>

    <form method="GET" action="{{ url_for('app_routes.admin_search') }}" class="d-flex mb-3">
        <input type="text" name="q" class="form-control me-2" placeholder="Search..." value="{{ query }}">
        <select name="type" class="form-select me-2">
            <option value="all" {% if search_type == 'all' %}selected{% endif %}>All</option>
            <option value="users" {% if search_type == 'users' %}selected{% endif %}>Users</option>
            <option value="subjects" {% if search_type == 'subjects' %}selected{% endif %}>Subjects</option>
            <option value="chapters" {% if search_type == 'chapters' %}selected{% endif %}>Chapters</option>
            <option value="quizzes" {% if search_type == 'quizzes' %}selected{% endif %}>Quizzes</option>
            <option value="questions" {% if search_type == 'questions' %}selected{% endif %}>Questions</option>
        </select>
        <button type="submit" class="btn btn-primary">Search</button>
    </form>

    {% if users %}
    <h3>Users</h3>
    <table class="table">
        <thead>
            <tr><th>Name</th><th>Email</th></tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr><td>{{ user.username }}</td><td>{{ user.email }}</td></tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    {% if subjects %}
    <h3>Subjects</h3>
    <ul>
        {% for subject in subjects %}
        <li>{{ subject.name }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if chapters %}
    <h3>Chapters</h3>
    <ul>
        {% for chapter in chapters %}
        <li>{{ chapter.name }} (Subject: {{ chapter.subject.name }})</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if quizzes %}
    <h3>Quizzes</h3>
    <ul>
        {% for quiz in quizzes %}
        <li>{{ quiz.name }} (Subject: {{ quiz.chapter.subject.name }}, Chapter: {{ quiz.chapter.name }})</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if questions %}
    <h3>Questions</h3>
    <ul>
        {% for question in questions %}
        <li>{{ question.question_statement }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if not users and not subjects and not chapters and not quizzes and not questions and query %}
    <p>No results found for "{{ query }}".</p>
    {% endif %}
</div>
{% endblock %}
